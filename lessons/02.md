# Digitando em campos e clicando em elementos

Uma das tarefas mais comuns quando se trata de testar aplica√ß√µes web √© a intera√ß√£o com campos de texto, tais como os campos de nome, sobrenome, email, telefone e √°rea de texto da aplica√ß√£o CAC TAT.

Para lidar com tais campos, o Cypress oferece uma funcionalidade chamada [`.type()`](https://on.cypress.io/type), a qual a tradu√ß√£o √© `digitar`.

Al√©m disso, depois de digitarmos em campos, normalmente, temos que clicar em algum bot√£o, por exemplo, para que uma a√ß√£o seja disparada, tal como o envio dos dados de um formul√°rio.

Para isso, o Cypress oferece a funcionalidade [`.click()`](https://on.cypress.io/click).

Mas antes de nos aprofundarmos nos comandos `.type()` e `.click()`, deixe-me apresentar o comando [`cy.get()`](https://on.cypress.io/get).

O comando `cy.get()` √© um dos comandos mais utilizados, pois nos permite identificar os elementos com os quais queremos interagir ou fazer verifica√ß√µes.

A maneira mais comum de usar o comando `cy.get()` √© pass√°-lo um seletor CSS como um argumento (como uma _string_), que identifica um (ou mais) elemento(s), para posterior a√ß√£o ou verifica√ß√£o. Por exemplo, `cy.get('[data-test="avatar"]')`.

> **Importante:** O Cypress possui [mecanismos de re-tentativas](https://docs.cypress.io/guides/core-concepts/retry-ability) de execu√ß√£o de comandos. Ou seja, caso o Cypress n√£o consiga identificar um elemento por seu seletor CSS (ao usar o comando `cy.get()`, por exemplo), ele tentar√° novamente (por um determinado per√≠odo de tempo), antes de falhar o teste.

Agora, vamos dar uma olhada em algo que voc√™ j√° fez na li√ß√£o anterior, usando o comando `.should()`, mas olhando de uma forma mais abrangente.

## [Encadeamento de comandos](https://docs.cypress.io/guides/core-concepts/introduction-to-cypress#Chains-of-Commands)

No Cypress, ao contr√°rio de outras ferramentas de automa√ß√£o de teste, a maioria dos comandos podem ser encadeados.

Ou seja, em vez de armazenar o retorno de um `cy.get()` em uma vari√°vel para uso posterior, voc√™ encadeia comandos √† ele, como `.should()`, `.type()` ou `. click()`.

Por exemplo: `cy.get('input[type="text"]').type('Ol√° mundo!')`.

Por√©m, a coisa n√£o para por a√≠.

O comando `cy.get()` passa adiante ao pr√≥ximo comando o elemento encontrado. Al√©m disso, outros comandos, tais como `.type()` e `.click()` (dentre outros), tamb√©m passam adiante o mesmo elemento, possibilitando encadearmos novos comandos, por exemplo, para fazer uma verifica√ß√£o.

Algo como o seguinte:

```js
cy.get('input[type="text"]')
  .type('Ol√° mundo!')
  .should('have.value', 'Ol√° mundo!')

```

Podemos at√© mesmo fazer verifica√ß√µes intermedi√°rias.

Por exemplo, antes de digitar no campo, podemos verificar se tal elemento est√° vis√≠vel.

```js
cy.get('input[type="text"]')
  .should('be.visible')
  .type('Ol√° mundo!')
  .should('have.value', 'Ol√° mundo!')
  
```

**Obs.:** Embora voc√™ possa encadear um comando `.should()` ao `.type()`, idealmente, voc√™ n√£o deveria, pois [as a√ß√µes devem estar no final das cadeias, n√£o no meio](https://docs.cypress.io/guides/core-concepts/retry-ability#Actions-should-be-at-the-end-of-chains-not-the-middle). Isso ocorre porque [apenas comandos do tipo _query_ s√£o re-tentados](https://docs.cypress.io/guides/core-concepts/retry-ability#Only-queries-are-retried).

> Durante os exerc√≠cios, eu irei encadear um comando `.should()` ap√≥s um `.type()` (ou outro comando de a√ß√£o), mas isso ocorre apenas porque a aplica√ß√£o CAC TAT √© uma aplica√ß√£o de exemplo, n√£o uma aplica√ß√£o real.
>
>  Leia a [documenta√ß√£o oficial](https://docs.cypress.io/api/table-of-contents#Commands) para mais detalhes sobre os diferentes tipos de comandos que o Cypress oferece (`query`, `assertion`, `action` e `outros`).
>
>  Uma alternativa melhor para a cadeia de comandos acima seria a seguinte.

```js
cy.get('input[type="text"]')
  .as('textField')
  .should('be.visible')
  .type('Ol√° mundo!')
cy.get('@textField')
  .should('have.value', 'Ol√° mundo!')

```

>  Com os comandos acima, logo ap√≥s obter o `input` do tipo `text`, eu crio uma refer√™ncia √† ele, dando-lhe um [alias](https://docs.cypress.io/api/commands/as) e deixo o comando `.type()` no final. Depois, obtenho o mesmo elemento pelo seu alias (`cy.get('@textField')`) e ent√£o executo a verifica√ß√£o final.

Agora que voc√™ leu a documenta√ß√£o oficial do Cypress sobre os comandos `cy.get()`, `.type()`, `.click()` e `.as()` e est√° familiarizado(a) com as re-rentativas e encadeamento de comandos, que tal alguns exerc√≠cios?

## Exerc√≠cio

1. No teste da li√ß√£o anterior, mova o comando `visit` para um bloco [`beforeEach()`](https://docs.cypress.io/guides/core-concepts/writing-and-organizing-tests#Hooks).
2. Logo abaixo do teste existente, adicione um novo teste, chamado `preenche os campos obrigat√≥rios e envia o formul√°rio`.
3. O teste deve combinar os comandos `cy.get()`, `.type()` e `.click()`, para digitar alguns dados nos campos **Nome**, **Sobrenome**, **E-mail** e **Como podemos te ajudar? Algum elogio ou feedback para n√≥s?**, al√©m de clicar no bot√£o **Enviar**.
4. Ap√≥s o clique, uma mensagem de sucesso deve ser exibida (esta mensagem deve estar contida em um elemento com a classe `success` üôä). Verifique se tal mensagem est√° vis√≠vel (`.should('be.visible')`).
5. Execute o novo teste na _Cypress App_ e quando o mesmo estiver passando siga adiante para o exerc√≠cio extra 1.

>  Se voc√™ precisa de "uma m√£o" com seletores CSS antes de resolver o exerc√≠cio, recomendo assistir a seguinte [live](https://youtu.be/HxJvAL4CHYE) que fiz no [Canal TAT no YouTube](https://www.youtube.com/c/talkingabouttesting) em Mar√ßo de 2021.
>
> Ou ent√£o, me veja resolvendo o problema, onde explico cada detalhe.

## Exerc√≠cio extra 1

No objeto de `options` que podemos passar ao comando `.type()`, √© poss√≠vel sobrescrever o `delay` padr√£o por outro valor (em milissegundos).

Quando o valor `0` √© passado, a digita√ß√£o no campo acontece de forma imediata.

Portanto, experimente digitar um texto longo na √°rea de texto, passando como segundo argumento ao comando `.type()` um objeto (`{}`), com a propriedade `delay` com valor `0`.

>  Para mais detalhes sobre a op√ß√£o `delay`, leia a [documenta√ß√£o oficial do Cypress](https://docs.cypress.io/api/commands/type#Arguments).

Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o pr√≥ximo exerc√≠cio.

## Exerc√≠cio extra 2

1. Crie um teste chamado `exibe mensagem de erro ao submeter o formul√°rio com um email com formata√ß√£o inv√°lida`
2. Tal teste deve verificar que uma mensagem √© exibida em um elemento com a classe `error` üôä
3. Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o pr√≥ximo exerc√≠cio

## Exerc√≠cio extra 3

Visto que o campo de telefone s√≥ aceita n√∫meros, crie um teste para validar que, se um valor n√£o-num√©rico for digitado, seu valor continuar√° vazio.

>  Pra te ajudar com a verifica√ß√£o do valor de um input, recomendo a leitura do [seguinte conte√∫do](https://docs.cypress.io/faq/questions/using-cypress-faq#How-do-I-get-an-inputs-value), direto da documenta√ß√£o oficial do Cypress.
> O primeiro exemplo deve ser o suficiente.
>
> Ou ent√£o, me veja resolvendo o problema.

Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o pr√≥ximo exerc√≠cio.

## Exerc√≠cio extra 4

1. Crie um teste chamado `exibe mensagem de erro quando o telefone se torna obrigat√≥rio mas n√£o √© preenchido antes do envio do formul√°rio`
2. Tal teste deve verificar que uma mensagem √© exibida em um elemento com a classe `error`
3. Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o pr√≥ximo exerc√≠cio

## Exerc√≠cio extra 5

Uma funcionalidade que pode ser usada em conjunto com comando o `.type()`, √© o [`.clear()`](https://on.cypress.io/clear), o qual limpa um campo, para posterior digita√ß√£o, por exemplo.

1. Portanto, crie um teste chamado `preenche e limpa os campos nome, sobrenome, email e telefone`
2. Tal teste deve verificar o valor (`value`) ap√≥s a digita√ß√£o (`.type(...).should('have.value', 'valor-aqui')`) e ap√≥s a limpeza do campo (`.clear().should('have.value', '')`)
3. Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o pr√≥ximo exerc√≠cio

## Exerc√≠cio extra 6

1. Crie um novo teste chamado `exibe mensagem de erro ao submeter o formul√°rio sem preencher os campos obrigat√≥rios`.
2. O teste deve simplesmente acessar a aplica√ß√£o e clicar no bot√£o **Enviar**
3. Tal teste deve verificar que uma mensagem √© exibida em um elemento com a classe `error`
4. Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o pr√≥ximo exerc√≠cio

## Exerc√≠cio extra 7 - [Comandos customizados](https://docs.cypress.io/api/cypress-api/custom-commands)

No mundo de testes automatizados com Cypress, podemos fazer uso de comandos customizados para evitar duplica√ß√£o de c√≥digo.

Escrevi sobre o assunto em Fevereiro de 2021, em um conte√∫do chamado [Como criar comandos customizados com Cypress](https://talkingabouttesting.com/2021/02/10/como-criar-comandos-customizados-com-cypress/). Recomendo a leitura.

Al√©m disso, em Abril de 2021, fiz um v√≠deo para a _playlist_ `cy.handsOn()` do Canal TAT no YouTube, chamado [Cypress Page Object vs GUI Custom Commands](https://youtu.be/1OkfwHUJ-fk), no qual brevemente comento sobre minha prefer√™ncia por comandos customizados em vez do padr√£o _Page Objects_ quando se trata de testes automatizados escritos com Cypress.

Teu exerc√≠cio √©:

1. Criar um teste chamado `envia o formu√°rio com sucesso usando um comando customizado`
2. Tal teste deve fazer uso de um comando chamado `fillMandatoryFieldsAndSubmit`, o qual deve ser implementado no arquivo `cypress/support/commands.js`

>  Sugiro que voc√™ experimente diferentes implementa√ß√µes para o mesmo comando (por exemplo, um comando que n√£o recebe nenhum argumento; um comando que recebe um objeto como argumento; um comando que recebe um objeto como argumento, com valores padr√£o).

3. Deve haver a verifica√ß√£o de que a mensagem de sucesso √© exibida
4. Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o pr√≥ximo exerc√≠cio

## Exerc√≠cio extra 8

Outra forma de identificar elementos (para, por exemplo, clicar neles ap√≥s sua defini√ß√£o) √© o uso da funcionalidade [`cy.contains()`](https://on.cypress.io/contains).

Com o comando `cy.contains()`, al√©m de um seletor CSS, voc√™ pode passar como segundo argumento um texto, o qual deve estar contido no elemento o qual voc√™ deseja identificar.

Por exemplo, se voc√™ tivesse o seguinte elemento HTML `<a href="https://example.com">Clique aqui!</a>`, voc√™ poderia identific√°-lo usando o seguinte comando `cy.contains('a', 'Clique aqui!')`.

Teu exerc√≠co √© alterar todos os locais onde identificamos o bot√£o para posterior clique, onde em vez de identificarmos tal elemento com o `cy.get()`, iremos usar o `cy.contains()`.

>  Lembre-se de executar todos os testes ap√≥s a altera√ß√£o para garantir que suas mudan√ßas n√£o quebraram nada.

## Conte√∫dos sugeridos

Nos conte√∫dos listados abaixo, fa√ßo diferentes usos do comando `.type()`.

- [Como preencher e submeter formul√°rios com Cypress](https://talkingabouttesting.com/2021/02/05/como-preencher-e-submeter-formularios-com-cypress/)
- [Como proteger dados sens√≠veis com Cypress](https://talkingabouttesting.com/2021/02/09/como-proteger-dados-sensiveis-com-cypress/)
- [3 maneiras de testar funcionalidades de busca com Cypress.io](https://youtu.be/bqz7sv-LgrM)
- [Testando busca com auto-complete usando Cypress](https://youtu.be/3qUq0XkPwts)
- [Como testar campos de data com Cypress](https://youtu.be/wiDOdfmuR2o)

Espero que goste dos conte√∫dos!

## Mostre ao mundo o que voc√™ aprendeu

Para mostrar √† sua rede profissional o que voc√™ aprendeu at√© agora, poste o seguinte no LinkedIn.

> Estou fazendo o curso "Cypress, do Zero √† Nuvem" da escola online Talking About Testing, onde aprendi sobre encadeamento de comandos, re-tentativas e alguns dos comandos mais comuns do Cypress. #TalkingAboutTesting #EscolaTAT #CypressDoZeroANuvem #Cypress

**Obs.:** Lembre-se de me marcar em sua postagem. [Aqui est√° meu perfil no LinkedIn](https://www.linkedin.com/in/walmyr-lima-e-silva-filho).

___

Parab√©ns! Vamos para a [li√ß√£o 3](./03.md) para aprender como selecionar op√ß√µes em campos de sele√ß√£o suspensa.
